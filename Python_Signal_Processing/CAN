import numpy as np
import matplotlib.pyplot as plt
from rtlsdr import RtlSdr

# Configure the SDR
sdr = RtlSdr()
sdr.sample_rate = 2e6  # 2 MS/s
sdr.center_freq = 125.5e6  # 125 MHz upconverter + 500 kHz
sdr.gain = 'auto'

# Read samples
num_samples = 1024 * 1024
samples = sdr.read_samples(num_samples)

# Close the SDR
sdr.close()

# Perform FFT
fft_samples = np.fft.fft(samples)
fft_magnitude = np.abs(fft_samples)

# Frequency axis (in Hz)
freqs = np.fft.fftfreq(len(samples), 1/sdr.sample_rate)

# Plot the absolute value of the Fourier Transform
plt.figure(figsize=(12, 6))
plt.plot(freqs[:len(freqs)//2], fft_magnitude[:len(freqs)//2])  # Plot only the positive frequencies
plt.xlabel('Frequency (Hz)')
plt.ylabel('Magnitude')
plt.title('Absolute Value of the Fourier Transform')
plt.grid(True)
plt.show()